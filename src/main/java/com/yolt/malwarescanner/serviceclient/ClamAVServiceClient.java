package com.yolt.malwarescanner.serviceclient;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;
import xyz.capybara.clamav.ClamavClient;
import xyz.capybara.clamav.commands.scan.result.ScanResult;

import java.io.InputStream;

@Component
public class ClamAVServiceClient {

    private final ClamavClient clamavClient;

    public ClamAVServiceClient(@Value("${clamav.host}") final String host,
                               @Value("${clamav.port}") final int port) {
        clamavClient = new ClamavClient(host, port);
    }

    public ScanResult scan(final InputStream fileInputStream) {
        return clamavClient.scan(fileInputStream);
    }

    public void ping() {
        clamavClient.ping();
    }

    public String version() {
        return clamavClient.version();
    }
}
